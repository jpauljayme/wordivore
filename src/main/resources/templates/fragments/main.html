<main th:fragment="userLandingMain" id="main" xmlns:th="http://www.w3.org/1999/xhtml">
  <div id="userLibraryLanding" class="library-page">
      <section class="library__section library__section--current">
          <div class="section__header">
              <span class="section__title" th:text="${'Current Reads ' + '(' + libraryCurrentReadsCount + ')'}">Currently Reading (0)</span>
          </div>

          <p th:if="${#lists.isEmpty(libraryCurrentReads)}">Nothing here yet.</p>
          <div th:replace="~{fragments/main :: shelfView(books=${libraryCurrentReads})}">
          </div>
          <button class=""
            th:attr="hx-get=@{/books/all}"
                  hx-push-url="true"
                  hx-target="main"
                  hx-swap="outerHTML"
          >
              View all
          </button>
      </section>
    <hr>

    <section class="library__section library__section--to--read">
        <header class="section__header">
            <span class="section__title"
                      th:text="${ 'To Read: ' + libraryToReadCount}">
            </span>
        </header>

        <div th:replace="~{fragments/main :: shelfView(books=${libraryToRead})}"></div>
    </section>
  </div>
</main>

<div th:if="${not #lists.isEmpty(books)}"
     th:each="b : ${books}"
     th:fragment="shelfView(books)"
     class="shelf"
>

    <article class="shelf__item">
        <img th:src="${ prefix + b.coverKey}" class="shelf__cover" alt="book cover">
    </article>
</div>

<div th:if="${not #lists.isEmpty(books)}"
     th:each="b : ${books}"
     th:fragment="list(books)"
     class="shelf shelf--list"
>

    <article class="shelf__item shelf__item--detailed">
        <div class="shelf__media">
            <img th:src="${ prefix + b.coverKey}" class="img--work" alt="book cover">
        </div>
        <div class="shelf__meta">
            <h3 class="shelf__title--h3">
                <span class="shelf__title" th:text="${ b.title }"></span>
                <span class="shelf__edition" th:text="${ b.editionName}"></span>
            </h3>
            <div class="shelf__authors">
                <span class="shelf__author" th:each="author : ${b.authors}" th:text="${author}" ></span>
            </div>

            <span class="shelf__page" th:text="${ b.pages + ' pages'}"></span>
            <span class="shelf__publicationDate" th:text="${ b.publicationDate }"></span>

            <ul class="shelf__subjects">
                <li class="shelf__subject text-xs" th:each="subject, stat : ${b.subjectsTop4}">
                    <span th:text="${subject}"></span>
                </li>
            </ul>

            <div>
                <label for="status-select">
                    Current Status
                </label>
                <select id="status-select">
                    <option value="TO_READ">to read</option>
                    <option value="CURRENTLY_READING">currently reading</option>
                    <option value="READ">read</option>
                    <option value="DNF">did not finish</option>
                </select>
            </div>

            <span class="shelf__status" th:text="${ b.status.getStatus()}"></span>
        </div>
    </article>
</div>



<main th:fragment="viewAll" id="viewAll" class="reads-page">
    <header class="reads-page__header">
        <span class="section__title">Current reads</span>
        <span class="section__title" th:if="${libraryCurrentReadsCount} > 1" th:text="${libraryCurrentReadsCount + ' books'}"></span>
        <span class="section__title" th:if="${libraryCurrentReadsCount == 1}" th:text="${libraryCurrentReadsCount + ' book'}"></span>
    </header>
    <div id="userLibraryViewAll"
         th:replace="~{fragments/main :: list(books=${libraryCurrentReads})}"
    >
    </div>
</main>
